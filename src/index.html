<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- <script src="index.js" ></script> -->
    <script type="module">
        import encode from './index.js'

        function arrayBufferToBlob(buffer, type) {
            return new Blob([buffer], {
                type: type
            });
        }


        let opt = {
            optimizationLevel: 3,
            interlaced: false,
            colors: 200,
            lossy:80,
            // width: 10,
            // height: number,
        }
        console.time()
        fetch('33.gif').then(d => d.arrayBuffer()).then(d => {
            let buf = new Uint8Array(d)
            encode(buf, opt).then(output => {
                console.log(output.buffer);

                let gif = arrayBufferToBlob(output.buffer, 'image/gif')
                console.log((gif.size/1000/1000).toFixed(2) +' Mb');
                console.timeEnd()

                let url = URL.createObjectURL(gif)
                open(url)
                // fs.writeFileSync('4.gif', output);

            });
        })
        // const reader = new FileReader();
        // reader.addEventListener('loadend', (e) => {
        //     resolve(reader.result);
        // });
        // reader.addEventListener('error', reject);
        // reader.readAsArrayBuffer(new Response);


        /* JavaScript module code here */
    </script>
</head>

<body>

</body>

</html>